"use strict";function _defineProperty(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}define("bundles/ondemand/components/reading/Reading",["require","exports","module","react-with-addons","bundles/CMLConverter/CMLVariableNames","bundles/ondemand/actions/ProgressActions","bundles/phoenix/components/CMLPreview","bundles/phoenix/lib/waitForStores","bundles/phoenix/template/models/userIdentity","pages/open-course/common/models/itemMetadata","pages/open-course/common/constants","pages/open-course/supplement/utils/supplementProgressApi","css!./__styles__/Reading"],function(require,exports,module){var e=require("react-with-addons"),s=require("bundles/CMLConverter/CMLVariableNames"),n=require("bundles/ondemand/actions/ProgressActions"),r=n.updateProgress,o=require("bundles/phoenix/components/CMLPreview"),a=require("bundles/phoenix/lib/waitForStores"),t=require("bundles/phoenix/template/models/userIdentity"),i=require("pages/open-course/common/models/itemMetadata"),p=require("pages/open-course/common/constants"),u=require("pages/open-course/supplement/utils/supplementProgressApi"),d="supplement_link_tracking";require("css!./__styles__/Reading");var l=e.createClass({displayName:"Reading",propTypes:{itemMetadata:e.PropTypes.instanceOf(i).isRequired,readingCml:e.PropTypes.object.isRequired,courseProgress:e.PropTypes.object.isRequired},contextTypes:{executeAction:e.PropTypes.func.isRequired},componentDidMount:function componentDidMount(){this.markComplete()},getVariableData:function getVariableData(){var e;return e={},_defineProperty(e,s.NAME,t.get("full_name")),_defineProperty(e,s.USER_ID,t.get("id")),e},getLinkEventingData:function getLinkEventingData(){return{key:d,value:{course_slug:this.props.itemMetadata.get("course.slug"),user_id:t.get("id"),timestamp:Date.now()}}},markComplete:function markComplete(){var e=this.props,t=e.courseProgress,o=e.itemMetadata,s=o.getId(),n=t.getItemProgress(s);n.isComplete()||u.markComplete(s).then(function(){n.setState(p.progressCompleted,{refreshCourseProgress:!0}),this.context.executeAction(r,t)}.bind(this)).done()},render:function render(){return e.createElement(o,{cml:this.props.readingCml,variableData:this.getVariableData(),linkEventingData:this.getLinkEventingData(),shouldRenderMath:!0,shouldApplyStyles:!0,className:"rc-Reading"})}});module.exports=a(l,["ProgressStore"],function(e,s){var t=e.ProgressStore;return{courseProgress:t.courseProgress}})});