"use strict";var _extends=Object.assign||function(n){for(var e=1;e<arguments.length;e++){var s=arguments[e];for(var t in s)Object.prototype.hasOwnProperty.call(s,t)&&(n[t]=s[t])}return n};define("bundles/ondemand/components/quiz/QuizItem",["require","exports","module","classnames","q","react-with-addons","bundles/assess/assessmentTypes/phoenixQuiz/assessment","bundles/assess/assessmentTypes/phoenixQuiz/assessment.attempt","bundles/content-feedback/constants/ItemTypes","bundles/ondemand/components/ItemLayout","bundles/ondemand/components/item/LightItemLayout","bundles/ondemand/utils/componentDataFetcher","bundles/ondemand/utils/itemViewValidator","bundles/phoenix/components/OrigamiRegion","pages/open-course/assessment/clients/contentRequesterAssessmentClient","pages/open-course/assessment/clients/naptimeAssessmentClient","pages/open-course/assessment/models/exam/assessment","pages/open-course/assessment/models/openSinglePage/assessment","pages/open-course/assessment/models/quiz/assessment","pages/open-course/common/contentRequester","pages/open-course/common/models/itemMetadata","pages/open-course/common/naptimeItemClient","pages/open-course/common/singletons/course","pages/open-course/common/singletons/courseGrade","pages/open-course/common/singletons/courseMaterials","pages/open-course/common/singletons/courseProgress","pages/open-course/common/singletons/verificationDisplay","pages/open-course/common/utils/lockExperiment","pages/open-course/verification/views/verification"],function(require,exports,module){function getContentModelPromise(e){if("assessOpenSinglePage"===e.getTypeName())return g({metadata:e});if("quiz"===e.getTypeName())return y({metadata:e});if("exam"===e.getTypeName())return s({metadata:e})}function getClient(e){if("assessOpenSinglePage"===e.getTypeName()||"quiz"===e.getTypeName()){var s=new f(e);return new d(s)}if("exam"===e.getTypeName()){var t=new h(e);return new l(e,t)}}var t=require("classnames"),n=require("q"),e=require("react-with-addons"),o=require("bundles/assess/assessmentTypes/phoenixQuiz/assessment"),a=require("bundles/assess/assessmentTypes/phoenixQuiz/assessment.attempt"),i=require("bundles/content-feedback/constants/ItemTypes"),r=require("bundles/ondemand/components/ItemLayout"),m=require("bundles/ondemand/components/item/LightItemLayout"),p=require("bundles/ondemand/utils/componentDataFetcher"),c=require("bundles/ondemand/utils/itemViewValidator"),u=require("bundles/phoenix/components/OrigamiRegion"),d=require("pages/open-course/assessment/clients/contentRequesterAssessmentClient"),l=require("pages/open-course/assessment/clients/naptimeAssessmentClient"),s=require("pages/open-course/assessment/models/exam/assessment"),g=require("pages/open-course/assessment/models/openSinglePage/assessment"),y=require("pages/open-course/assessment/models/quiz/assessment"),f=require("pages/open-course/common/contentRequester"),b=require("pages/open-course/common/models/itemMetadata"),h=require("pages/open-course/common/naptimeItemClient"),v=require("pages/open-course/common/singletons/course"),T=require("pages/open-course/common/singletons/courseGrade"),q=require("pages/open-course/common/singletons/courseMaterials"),x=require("pages/open-course/common/singletons/courseProgress"),P=require("pages/open-course/common/singletons/verificationDisplay"),w=require("pages/open-course/common/utils/lockExperiment"),I=require("pages/open-course/verification/views/verification"),C={start:o,verify:I,attempt:a},M=e.createClass({displayName:"QuizItem",propTypes:{itemMetadata:e.PropTypes.instanceOf(b).isRequired,isComponentLoaded:e.PropTypes.bool.isRequired,course:e.PropTypes.object.isRequired,courseProgress:e.PropTypes.object.isRequired,courseMaterials:e.PropTypes.object.isRequired,courseGrade:e.PropTypes.object.isRequired,verificationDisplay:e.PropTypes.object.isRequired,model:e.PropTypes.object.isRequired,nextItemMetadata:e.PropTypes.object.isRequired},getInitialState:function getInitialState(){return{state:"start",stateOptions:{}}},componentDidMount:function componentDidMount(){var e=this.props,s=e.course,t=e.courseMaterials,n=e.courseGrade,o=e.courseProgress;w.setup(s.get("id"),t,n,o)},onStateChange:function onStateChange(e,s){this.setState({state:e,stateOptions:s||{}})},renderView:function renderView(){var a=this.props.isComponentLoaded,n=this.state,s=n.state,i=n.stateOptions,o=C[s];if(!o)throw new Error("Unknown state: "+s);var r=t("rc-QuizItem",{state:s});return e.createElement("div",{className:r},a&&e.createElement(u,{ViewClass:o,viewOptions:_extends({},this.props,i,{onStateChange:this.onStateChange})}))},render:function render(){var t=this.props.itemMetadata,n=this.state.state,s=this.renderView();return"start"===n?e.createElement(r,null,e.createElement(m,{itemMetadata:t,itemType:i.Quiz,isCard:!0},s)):s}}),R=p(M,function(s,t){var e=s.itemMetadata;return n.all([getContentModelPromise(e),v,T,x,q,P]).spread(function(t,n,o,a,s,i){return{course:n,courseProgress:a,courseMaterials:s,courseGrade:o,verificationDisplay:i,assessmentClient:getClient(e),model:t,nextItemMetadata:s.getNeighboringItemMetadata(e).next}})});module.exports=c(R,{renderItemLayout:!0})});